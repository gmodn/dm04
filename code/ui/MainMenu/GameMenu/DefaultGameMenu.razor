@using System
@using Sandbox;
@using Sandbox.MenuSystem;
@using Sandbox.UI;
@attribute [StyleSheet]
@inherits Sandbox.UI.NavHostPanel
@implements Sandbox.Menu.IGameMenuPanel
@namespace Sandbox.UI.GameMenu

@if (!Game.InGame)
{
}

<root class="gamemainmenu">

    <div class="navigator-canvas" slot="navigator-canvas"></div>

</root>

@code
{
    public DefaultGameMenu()
    {
        DefaultUrl = "/splash";

        AddDestination("/splash", typeof(SplashPage));

        if (Game.InGame) Navigate("/active");

        AddDestination("/", typeof(FrontPage));

        BindClass( "ingame", () => Game.InGame );
        BindClass("inlobby", () => Game.Menu.Lobby != null);
    }

    protected override void OnEvent( PanelEvent e )
    {
        if ( e.Name == "package.changed" )
        {
            StateHasChanged();
            return;
        }

        base.OnEvent( e );
    }

    [GameEvent.Menu.LobbyLeave]
    public void OnLobbyLeave() => Navigate("/");

    [GameEvent.Menu.ServerLeave]
    public void OnServerLeave() => Navigate("/");
}
